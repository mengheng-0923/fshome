<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <script>
      // promise核心方法
      promise
        .then((result) => console.log(result))
        .catch((error) => console.error(error))
        .finally((data) => console.log(data));
      //   并发请求
      const fetchUser = () =>
        fetch("https://api.example.com/users/1").then((res) => res.json());

      const fetchPosts = () =>
        fetch("https://api.example.com/posts?userId=1").then((res) =>
          res.json()
        );

      Promise.all([fetchUser(), fetchPosts()])
        .then(([user, posts]) => {
          console.log("用户:", user);
          console.log("文章:", posts);
        })
        .catch((error) => console.error("并发请求失败:", error));
      // 链式调用
      const login = (user) => {
        return new Promise((resolve) => {
          setTimeout(() => resolve({ token: "abc123", user }), 500);
        });
      };

      const getProfile = (token) => {
        return new Promise((resolve) => {
          setTimeout(() => resolve({ name: "John", age: 25 }), 300);
        });
      };

      login("admin")
        .then((response) => getProfile(response.token))
        .then((profile) => console.log(profile))
        .catch((error) => console.error("流程中断:", error));
        
    </script>
  </body>
</html>
